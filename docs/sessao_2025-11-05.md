# Resumo da sessão — 2025-11-05

Objetivo
- Habilitar HTTPS no Vite e permitir testes em dispositivos móveis (câmera e HMR).

Pacotes instalados
- @vitejs/plugin-basic-ssl — habilita HTTPS no dev server do Vite.
- cloudflared (dev) — túnel público via TryCloudflare, certificado confiável.
- localtunnel (dev) — túnel público via loca.lt (pode exibir intersticial “click to submit”).

Configurações aplicadas (vite.config.ts)
- plugins: adicionada `basicSsl()` de `@vitejs/plugin-basic-ssl`.
- server.host: `true` (expor na LAN).
- server.port: `5174` (fixo).
- server.https: `true` (HTTPS ativo).

Servidores e URLs
- Dev server: `https://localhost:5174/` e `https://192.168.1.26:5174/` (LAN).
  - Observação: em dispositivos móveis, o IP com HTTPS apresenta `net::ERR_CERT_AUTHORITY_INVALID` por ser certificado autoassinado.
- Túnel loca.lt: `https://cool-donkeys-bake.loca.lt` (funciona, mas tem intersticial “click to submit”).
- Túnel Cloudflare (TryCloudflare):
  - Primeiro teste gerou 502 (verificação TLS do origin).
  - Solução: relançado com `--no-tls-verify`.
  - URL final: `https://matching-hawaiian-saints-rapidly.trycloudflare.com` (sem intersticial, certificado confiável, câmera/HMR OK).

Como reiniciar depois
1) Dev server (na raiz do projeto):
   - `npm run dev -- --host --port 5174`
   - Certifique-se que `vite.config.ts` mantém `basicSsl()`, `https: true`, `host: true`.

2) Túnel Cloudflare (recomendado):
   - `npx cloudflared tunnel --no-tls-verify --url https://localhost:5174`
   - Ao iniciar, o terminal mostrará uma URL `https://<subdominio>.trycloudflare.com`.
   - Mantenha o dev server e o túnel abertos enquanto testar no celular.

3) Alternativa loca.lt (se preferir):
   - `npx localtunnel --port 5174`
   - A saída mostrará `https://<subdominio>.loca.lt`.
   - Pode pedir interação em alguns ambientes.

Notas importantes
- TryCloudflare gera URLs temporárias; se cair, relance o comando para um novo subdomínio.
- Para usar diretamente o IP local com HTTPS sem aviso no celular, é possível gerar e confiar certificados com `mkcert` (opção avançada).
- Para testar apenas UI sem câmera, use `http://192.168.1.26:5174/` (sem HTTPS), mas `getUserMedia` não funciona.
- Windows Firewall: garanta permissão para o Node/Vite aceitar conexões na LAN.

Estado atual
- Dev server configurado com HTTPS e LAN.
- Túnel Cloudflare ativo durante a sessão com `--no-tls-verify`.
- Links salvos em `docs/links_tuneis_2025-11-05.txt`.
